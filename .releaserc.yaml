branches:
    - name: "master"
preset: "python"
tagFormat: v${version}
plugins:
    - "@semantic-release/commit-analyzer"
    - "@semantic-release/release-notes-generator"
    - "@semantic-release/changelog"
    - "@semantic-release/git"
    - "@semantic-release/github"
    - [
          "@semantic-release/exec",
          {
              "prepareCmd": "docker build -t nicconike/steam-stats:${nextRelease.version} . && docker build -t nicconike/steam-stats:latest .",
              "publishCmd": "docker push nicconike/steam-stats:${nextRelease.version} && docker tag nicconike/steam-stats:${nextRelease.version} nicconike/steam-stats:latest && docker push nicconike/steam-stats:latest",
          },
      ]
verifyConditions:
    - "@semantic-release/git"
    - "@semantic-release/github"
analyzeCommits:
    - path: "@semantic-release/commit-analyzer"
      releaseRules:
    - type: "feat"
      release: "patch"
    - type: "hotfix"
      release: "patch"
    - type: "patch"
      release: "patch"
    - type: "minor"
      release: "minor"
    - type: "breaking"
      release: "major"
generateNotes:
    - path: "@semantic-release/release-notes-generator"
      writerOpts:
          groupBy: "type"
          commitGroupsSort:
              - "feat"
              - "perf"
              - "fix"
          commitsSort: "header"
      types:
          - type: "feat"
          - section: "Features"
          - type: "hotfix"
          - section: "Bug Fixes"
          - type: "fix"
          - hidden: true
          - type: "chore"
          - hidden: true
            presetConfig: true
prepare:
    - path: "@semantic-release/git"
    - path: "@semantic-release/changelog"
      changelogFile: "CHANGELOG.md"
publish:
    - path: "@semantic-release/github"

success:
    - "@semantic-release/github"

fail:
    - "@semantic-release/github"
